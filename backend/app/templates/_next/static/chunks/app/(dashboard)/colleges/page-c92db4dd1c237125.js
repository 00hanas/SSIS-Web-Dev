(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[281],{25800:(e,l,a)=>{"use strict";a.r(l),a.d(l,{default:()=>T});var t=a(95155),s=a(37772),o=a(97003),n=a(7220),r=a(42179),c=a(53e3),i=a(50533),d=a(36820),g=a(57972),h=a(33952),u=a(12115),m=a(54679),x=a(33789),p=a(90235),j=a(69818),C=a(41152);function y(e){let{onCollegeAdded:l}=e,[a,s]=(0,u.useState)(null),[n,r]=(0,u.useState)(""),[c,i]=(0,u.useState)(""),[d,g]=(0,u.useState)(""),[h,y]=(0,u.useState)(!1),[N,f]=(0,u.useState)(!1),v=async()=>{if(f(!0),!n.trim()||!c.trim()){g("Please fill in both fields."),f(!1);return}try{let e=await (0,j.M0)(n,c);s(e.college),r(""),i(""),g(""),y(!1),null==l||l()}catch(e){e instanceof Error?"College code already exists"===e.message?g("College Code (".concat(n,") is already taken.")):"Missing required fields"===e.message?g("Please fill in both College Code and College Name."):g(e.message||"Something went wrong. Try again."):g("Something went wrong. Try again.")}finally{f(!1)}},w=()=>{r(""),i(""),g("")};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(m.lG,{open:h,onOpenChange:e=>{e?y(!0):(w(),y(!1))},children:[(0,t.jsx)(m.zM,{asChild:!0,className:"cursor-pointer",children:(0,t.jsx)(o.$,{variant:"default",size:"sm",onClick:()=>y(!0),children:"Add College"})}),(0,t.jsxs)(m.Cf,{className:"sm:max-w-md",children:[(0,t.jsxs)(m.c7,{children:[(0,t.jsx)(m.L3,{children:"Add a new College"}),(0,t.jsx)(m.rr,{children:"Fill in the details below to add a college."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(p.J,{htmlFor:"collegeCode",children:"College Code"}),(0,t.jsx)(x.p,{id:"collegeCode",placeholder:"e.g. CCS",value:n,onChange:e=>r(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(p.J,{htmlFor:"collegeName",children:"College Name"}),(0,t.jsx)(x.p,{id:"collegeName",placeholder:"e.g. College of Computer Studies",value:c,onChange:e=>i(e.target.value)})]}),d&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-600",children:d})]}),(0,t.jsxs)(m.Es,{children:[(0,t.jsx)(o.$,{type:"button",variant:"outline",className:"mr-auto cursor-pointer",onClick:w,children:"Reset"}),(0,t.jsx)(m.HM,{asChild:!0,children:(0,t.jsx)(o.$,{className:"cursor-pointer",variant:"secondary",children:"Cancel"})}),(0,t.jsx)(o.$,{className:"cursor-pointer",type:"submit",onClick:v,disabled:N,children:N?"Saving...":"Save"})]})]})]}),a&&(0,t.jsx)(C.p,{entityType:"College",entity:{code:a.collegeCode,name:a.collegeName},actionType:"added",onClose:()=>s(null)})]})}function N(e){let{college:l,visible:a,onClose:s,onCollegeUpdated:n}=e,[r,c]=(0,u.useState)(l.collegeCode),[i,d]=(0,u.useState)(l.collegeName),[g,h]=(0,u.useState)(null),[y,N]=(0,u.useState)(""),[f,v]=(0,u.useState)(!1);(0,u.useEffect)(()=>{a&&(c(l.collegeCode),d(l.collegeName),N(""),(async()=>{try{let e=await (0,j.Av)(l.collegeCode);c(e.collegeCode),d(e.collegeName)}catch(e){console.error("Failed to fetch college data:",e)}})())},[a,l.collegeCode,l.collegeName]);let w=async()=>{let e=l.collegeCode;if(v(!0),!r.trim()||!i.trim()){N("Please fill in both fields."),v(!1);return}if(r.trim()===e.trim()&&i.trim()===l.collegeName.trim()){N("No changes detected."),v(!1);return}try{let l=await (0,j.N0)(e,r,i);h(l),N("")}catch(e){e instanceof Error?"College code already exists"===e.message?N("College Code (".concat(r,") is already taken.")):"Missing required fields"===e.message?N("Please fill in both College Code and College Name."):N(e.message||"Something went wrong. Try again."):N("Something went wrong. Try again.")}finally{v(!1)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.lG,{open:a,onOpenChange:e=>{e||s()},children:(0,t.jsxs)(m.Cf,{className:"sm:max-w-md",children:[(0,t.jsxs)(m.c7,{children:[(0,t.jsx)(m.L3,{children:"Edit College"}),(0,t.jsx)(m.rr,{children:"Update the fields below to modify this college."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(p.J,{htmlFor:"collegeCode",children:"College Code"}),(0,t.jsx)(x.p,{id:"collegeCode",value:r,placeholder:"e.g. CCS",onChange:e=>c(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(p.J,{htmlFor:"collegeName",children:"College Name"}),(0,t.jsx)(x.p,{id:"collegeName",value:i,placeholder:"e.g. College of Computer Studies",onChange:e=>d(e.target.value)})]}),y&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-600",children:y})]}),(0,t.jsxs)(m.Es,{children:[(0,t.jsx)(o.$,{type:"button",variant:"outline",className:"mr-auto cursor-pointer",onClick:()=>{c(""),d(""),N("")},children:"Reset"}),(0,t.jsx)(m.HM,{asChild:!0,children:(0,t.jsx)(o.$,{className:"cursor-pointer",variant:"secondary",children:"Cancel"})}),(0,t.jsx)(o.$,{className:"cursor-pointer",type:"submit",onClick:w,disabled:f,children:f?"Saving Changes...":"Save Changes"})]})]})}),g&&(0,t.jsx)(C.p,{entityType:"College",entity:{code:g.collegeCode,name:g.collegeName},actionType:"updated",onClose:()=>{h(null),null==n||n(),s()}})]})}function f(e){let{college:l,visible:a,onClose:s,onCollegeDeleted:n}=e,[r,c]=(0,u.useState)(null),i=async()=>{try{await (0,j.pZ)(l.collegeCode),c(l)}catch(e){console.error("Failed to delete college:",e)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.lG,{open:a,onOpenChange:e=>{e||s()},children:(0,t.jsxs)(m.Cf,{children:[(0,t.jsx)(m.c7,{children:(0,t.jsx)(m.L3,{children:"Confirm Deletion"})}),(0,t.jsxs)("p",{children:["Are you sure you want to delete"," ",(0,t.jsx)("strong",{children:l.collegeName})," (",l.collegeCode,")?"]}),(0,t.jsxs)(m.Es,{children:[(0,t.jsx)(o.$,{className:"cursor-pointer",variant:"secondary",onClick:()=>s(),children:"Cancel"}),(0,t.jsx)(o.$,{className:"cursor-pointer",variant:"destructive",onClick:i,children:"Delete"})]})]})}),r&&(0,t.jsx)(C.p,{entityType:"College",entity:{code:r.collegeCode,name:r.collegeName},actionType:"deleted",onClose:()=>{c(null),null==n||n(),s()}})]})}var v=a(4259),w=a(15310),S=a(99733),b=a(68122),E=a(47507);function T(){let e,{authenticated:l,loading:a}=(0,v.A)(),[m,x]=(0,u.useState)(!1),[p,C]=(0,u.useState)([]),[T,k]=(0,u.useState)(0),[A,F]=(0,u.useState)(null),[$,P]=(0,u.useState)(null),[O,G]=(0,u.useState)(""),[U,J]=(0,u.useState)("all"),[M,_]=(0,u.useState)("collegeCode"),[D,L]=(0,u.useState)("asc"),[B,R]=(0,u.useState)(1),[q,z]=(0,u.useState)(1),H=(0,u.useCallback)(async()=>{x(!0);try{let e=await (0,j.Uu)(B,15,O,U,M,D);C(e.colleges),z(e.pages),k(e.total)}catch(e){console.error("Failed to load colleges:",e)}finally{x(!1)}},[B,O,U,M,D]);return((0,u.useEffect)(()=>{l&&H()},[l,H]),(0,u.useEffect)(()=>{l&&H()},[l,H]),a)?(0,t.jsx)(w.J,{}):l||a?(0,t.jsxs)("div",{className:"container w-full justify-center px-6",children:[(0,t.jsx)("div",{className:"container mb-2",children:(0,t.jsx)("h1",{className:"mb text-2xl font-semibold tracking-wide",children:"Colleges"})}),(0,t.jsxs)("div",{className:"mb-4 flex",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(S.D,{value:O,onChange:G,total:T}),(0,t.jsxs)(E.l6,{value:U,onValueChange:e=>J(e),children:[(0,t.jsx)(E.bq,{className:"w-[150px] cursor-pointer",children:(0,t.jsx)(E.yv,{placeholder:"Search By"})}),(0,t.jsxs)(E.gC,{children:[(0,t.jsx)(E.eb,{className:"cursor-pointer",value:"all",children:"Search By"}),(0,t.jsx)(E.eb,{className:"cursor-pointer",value:"collegeCode",children:"College Code"}),(0,t.jsx)(E.eb,{className:"cursor-pointer",value:"collegeName",children:"College Name"})]})]})]}),(0,t.jsx)("div",{className:"ml-auto",children:(0,t.jsx)(y,{onCollegeAdded:H})})]}),(0,t.jsx)("div",{className:"container",children:m?(0,t.jsx)(b.E,{className:"container mx-auto h-[600px] rounded-xl py-10"}):0===p.length?(0,t.jsx)("div",{className:"text-muted-foreground py-6 text-center",children:"No data."}):(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"mb-2 opacity-100 transition-opacity duration-300",children:[(0,t.jsx)(h.b,{columns:(e=e=>{F(e)},[{accessorKey:"collegeCode",size:150,header:()=>(0,t.jsxs)(o.$,{onClick:()=>{"collegeCode"===M?L("asc"===D?"desc":"asc"):(_("collegeCode"),L("asc"))},className:"text-foreground cursor-pointer bg-transparent hover:bg-transparent",children:["College Code","collegeCode"===M?"asc"===D?(0,t.jsx)(c.A,{className:"text-primary ml-2 h-4 w-4"}):(0,t.jsx)(i.A,{className:"text-primary ml-2 h-4 w-4"}):(0,t.jsx)(d.A,{className:"text-primary ml-2 h-4 w-4"})]}),enableSorting:!0,cell:e=>{var l;let{getValue:a}=e;return null!=(l=a())?l:"—"}},{accessorKey:"collegeName",header:()=>(0,t.jsxs)(o.$,{onClick:()=>{"collegeName"===M?L("asc"===D?"desc":"asc"):(_("collegeName"),L("asc"))},className:"text-foreground cursor-pointer bg-transparent hover:bg-transparent",children:["College Name","collegeName"===M?"asc"===D?(0,t.jsx)(c.A,{className:"text-primary ml-2 h-4 w-4"}):(0,t.jsx)(i.A,{className:"text-primary ml-2 h-4 w-4"}):(0,t.jsx)(d.A,{className:"text-primary ml-2 h-4 w-4"})]}),enableSorting:!0,cell:e=>{var l;let{getValue:a}=e;return null!=(l=a())?l:"—"}},{id:"actions",cell:l=>{let{row:a}=l,c=a.original;return(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsxs)(n.rI,{children:[(0,t.jsx)(n.ty,{asChild:!0,children:(0,t.jsxs)(o.$,{variant:"ghost",className:"h-5 w-8 cursor-pointer p-0",children:[(0,t.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,t.jsx)(s.A,{className:"h-4 w-4"})]})}),(0,t.jsxs)(n.SQ,{align:"end",children:[(0,t.jsx)(n.lp,{children:"Actions"}),(0,t.jsx)(n.mB,{}),(0,t.jsxs)(o.$,{variant:"ghost",className:"flex w-full cursor-pointer justify-between",onClick:()=>e(c),children:["Edit",(0,t.jsx)(r.A,{className:"text-muted-foreground h-4 w-4"})]}),(0,t.jsxs)(o.$,{variant:"ghost",className:"flex w-full cursor-pointer justify-between",onClick:()=>P(c),children:["Delete",(0,t.jsx)(g.A,{className:"text-muted-foreground h-4 w-4"})]})]})]})})}}]),data:p,page:B,totalPages:q,setPage:R}),A&&(0,t.jsx)(N,{college:A,visible:!0,onClose:()=>F(null),onCollegeUpdated:()=>{H(),F(null)}}),$&&(0,t.jsx)(f,{college:$,visible:!0,onClose:()=>P(null),onCollegeDeleted:()=>{H(),P(null)}})]})})})]}):(0,t.jsx)("div",{className:"text-muted-foreground py-6 text-center",children:"Redirecting to login..."})}},69818:(e,l,a)=>{"use strict";a.d(l,{Av:()=>c,M0:()=>r,N0:()=>i,Uu:()=>o,bd:()=>s,lC:()=>g,pZ:()=>d,vf:()=>n});let t="http://127.0.0.1:5000/api/colleges",s=async()=>{let e=await fetch("".concat(t,"/list"),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),l=await e.json();return console.log("Fetched colleges:",l.colleges),l},o=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"collegeCode",n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"asc",r=new URLSearchParams({page:e.toString(),per_page:l.toString(),search:a,searchBy:"all"===s?"all":s,sortBy:o,order:n}),c=await fetch("".concat(t,"?").concat(r.toString()),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),i=await c.json();return console.log("Total colleges:",i.total),i},n=async()=>{let e=await fetch("".concat(t,"/dropdown"),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!e.ok)throw console.error("Server returned:",await e.text()),Error("Failed to fetch colleges");return(await e.json()).colleges},r=async(e,l)=>{let a=await fetch("".concat(t,"/create"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({collegeCode:e,collegeName:l})});if(!a.ok)throw Error((await a.json()).error||"Unknown error");return await a.json()},c=async e=>{let l=await fetch("".concat(t,"/").concat(e),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!l.ok)throw console.error("Fetch failed with status:",l.status),Error("Failed to fetch college");return await l.json()},i=async(e,l,a)=>{let s=await fetch("".concat(t,"/").concat(e),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({collegeCode:l,collegeName:a})}),o=await s.json();if(!s.ok)throw Error(o.error||"Failed to update college");return o.college},d=async e=>{let l=await fetch("".concat(t,"/").concat(e),{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"}}),a=l.headers.get("content-type");if(!l.ok)if(null==a?void 0:a.includes("application/json"))throw Error((await l.json()).error||"Failed to delete college");else throw Error("Unexpected server error");return await l.json()};async function g(){let e=await fetch("http://127.0.0.1:5000/api/colleges/total",{method:"GET",credentials:"include"});return(await e.json()).total}},79172:(e,l,a)=>{Promise.resolve().then(a.bind(a,25800))}},e=>{e.O(0,[186,629,179,40,14,91,52,441,255,358],()=>e(e.s=79172)),_N_E=e.O()}]);