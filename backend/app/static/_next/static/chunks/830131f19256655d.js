(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";e.s(["Card",()=>a,"CardContent",()=>i,"CardDescription",()=>n,"CardHeader",()=>s,"CardTitle",()=>l]);var t=e.i(43476),r=e.i(47163);function a(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...s})}function s(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...s})}function l(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",a),...s})}function n(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",a),...s})}function i(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",a),...s})}},10708,e=>{"use strict";e.s(["Label",()=>n],10708);var t=e.i(43476),r=e.i(71645),a=e.i(48425),s=r.forwardRef((e,r)=>(0,t.jsx)(a.Primitive.label,{...e,ref:r,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null==(r=e.onMouseDown)||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));s.displayName="Label";var l=e.i(47163);function n(e){let{className:r,...a}=e;return(0,t.jsx)(s,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",r),...a})}},78977,e=>{"use strict";e.s(["default",()=>U],78977);var t=e.i(43476),r=e.i(90239),a=e.i(41071),s=e.i(67881),l=e.i(63415),n=e.i(66040),i=e.i(96944);let o=(0,e.i(54624).default)((0,t.jsx)("path",{d:"M12 2c-4.97 0-9 4.03-9 9 0 4.17 2.84 7.67 6.69 8.69L12 22l2.31-2.31C18.16 18.67 21 15.17 21 11c0-4.97-4.03-9-9-9m0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3m0 14.3c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22"}),"PersonPin");var c=e.i(57688),d=e.i(9244),u=e.i(71645),m=e.i(30374),g=e.i(23750),h=e.i(10708),x=e.i(62870),p=e.i(88210),j=e.i(46197),f=e.i(66953),v=e.i(20755);function N(e){let{onStudentAdded:r}=e,[a,l]=(0,u.useState)(null),[n,i]=(0,u.useState)([]),[o,d]=(0,u.useState)(""),[N,S]=(0,u.useState)(""),[y,b]=(0,u.useState)(""),[C,w]=(0,u.useState)(""),[D,I]=(0,u.useState)(""),[L,F]=(0,u.useState)(""),[k,P]=(0,u.useState)(""),[B,T]=(0,u.useState)(!1),[U,M]=(0,u.useState)(null),[V,A]=(0,u.useState)(null),E=(0,u.useRef)(null);(0,u.useEffect)(()=>{(async()=>{try{let e=await (0,p.fetchProgramsForDropdown)();i(e)}catch(e){console.error("Failed to load programs:",e)}})()},[]);let R=async()=>{if(!o.trim()||!N.trim()||!y.trim()||!C.trim()||!D.trim()||!L.trim())return void P("Please fill in all fields.");if(!/^\d{4}-\d{4}$/.test(o.trim()))return void P("Student ID must follow the format XXXX-XXXX using digits only.");if(U){if(!["image/jpg","image/jpeg","image/png","image/svg+xml"].includes(U.type)){P("Only image files are allowed."),E.current&&(E.current.value="");return}if(U.size>2097152){P("Photo must be smaller than 2 MB."),E.current&&(E.current.value="");return}}try{let e="/student-icon.jpg";if(U){let t="".concat(o,"/").concat(Date.now(),"-").concat(U.name),{error:r}=await v.supabase.storage.from("students-photos").upload(t,U);if(r)console.error("Upload error:",r);else{let{data:r}=v.supabase.storage.from("students-photos").getPublicUrl(t);e=r.publicUrl}}let t=await (0,j.createStudent)(o,N,y,C,parseInt(D),L,e||"/student-icon.jpg");l(t.student),O(),T(!1),null==r||r()}catch(e){e instanceof Error?"Student ID already exists"===e.message?P("Student ID (".concat(o,") is already taken.")):"Missing required fields"===e.message?P("Please fill in all required fields."):P(e.message||"Something went wrong. Try again."):P("Something went wrong. Try again.")}},O=()=>{d(""),S(""),b(""),w(""),I(""),F(""),M(null),A(null),P("")};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(m.Dialog,{open:B,onOpenChange:e=>{e?T(!0):(O(),T(!1))},children:[(0,t.jsx)(m.DialogTrigger,{asChild:!0,className:"cursor-pointer",children:(0,t.jsx)(s.Button,{variant:"default",size:"sm",children:"Add Student"})}),(0,t.jsxs)(m.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(m.DialogHeader,{children:[(0,t.jsx)(m.DialogTitle,{children:"Add a new Student"}),(0,t.jsx)(m.DialogDescription,{children:"Fill in the details below to add a student."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,t.jsx)(h.Label,{htmlFor:"photo",children:"Photo (optional)"}),(0,t.jsxs)("div",{className:"relative flex items-center justify-center",children:[V?(0,t.jsx)(c.default,{src:V,alt:"Preview",width:120,height:120,className:"!h-20 !w-20 rounded-full border border-gray-300 object-cover"}):(0,t.jsx)("div",{className:"flex !h-20 !w-20 cursor-pointer items-center justify-center rounded-full bg-gray-100 text-gray-500",children:(0,t.jsx)("span",{className:"text-3xl font-bold",children:"+"})}),V&&(0,t.jsx)(s.Button,{variant:"destructive",size:"icon",onClick:()=>{M(null),A(null),E.current&&(E.current.value="")},className:"absolute -top-2 -right-2 !h-5 !w-5 rounded-full bg-red-500 text-white hover:bg-red-600",children:"✕"})]}),(0,t.jsx)(s.Button,{variant:"outline",onClick:()=>{var e;return null==(e=E.current)?void 0:e.click()},className:"px-4 py-2",children:V?"Change Photo":"Upload Photo"}),(0,t.jsx)("input",{ref:E,id:"photo",type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;let r=(null==(t=e.target.files)?void 0:t[0])||null;M(r),r&&A(URL.createObjectURL(r))}})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"studentID",children:"Student ID"}),(0,t.jsx)(g.Input,{id:"studentID",placeholder:"e.g. 2023-0001",value:o,onChange:e=>{let t=e.target.value.replace(/\D/g,"");t.length>4&&(t=t.slice(0,4)+"-"+t.slice(4,8)),d(t)},maxLength:9})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"firstName",children:"First Name"}),(0,t.jsx)(g.Input,{id:"firstName",placeholder:"e.g. Juhanara",value:N,onChange:e=>S(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"lastName",children:"Last Name"}),(0,t.jsx)(g.Input,{id:"lastName",placeholder:"e.g. Saluta",value:y,onChange:e=>b(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"programCode",children:"Program"}),(0,t.jsxs)(x.Select,{value:C,onValueChange:w,children:[(0,t.jsx)(x.SelectTrigger,{children:(0,t.jsx)(x.SelectValue,{placeholder:"Select a program"})}),(0,t.jsx)(x.SelectContent,{className:"max-h-[300px] overflow-y-auto",children:Array.isArray(n)&&n.map(e=>(0,t.jsxs)(x.SelectItem,{value:e.programCode,children:[e.programName," (",e.programCode,")"]},e.programCode))})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"yearLevel",children:"Year Level"}),(0,t.jsxs)(x.Select,{value:D,onValueChange:I,children:[(0,t.jsx)(x.SelectTrigger,{children:(0,t.jsx)(x.SelectValue,{placeholder:"Select year level"})}),(0,t.jsxs)(x.SelectContent,{children:[(0,t.jsx)(x.SelectItem,{value:"1",children:"1"}),(0,t.jsx)(x.SelectItem,{value:"2",children:"2"}),(0,t.jsx)(x.SelectItem,{value:"3",children:"3"}),(0,t.jsx)(x.SelectItem,{value:"4",children:"4"}),(0,t.jsx)(x.SelectItem,{value:"5",children:"5"})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"gender",children:"Gender"}),(0,t.jsxs)(x.Select,{value:L,onValueChange:F,children:[(0,t.jsx)(x.SelectTrigger,{children:(0,t.jsx)(x.SelectValue,{placeholder:"Select a gender"})}),(0,t.jsxs)(x.SelectContent,{children:[(0,t.jsx)(x.SelectItem,{value:"Female",children:"Female"}),(0,t.jsx)(x.SelectItem,{value:"Male",children:"Male"})]})]})]}),k&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-600",children:k})]}),(0,t.jsxs)(m.DialogFooter,{children:[(0,t.jsx)(s.Button,{type:"button",variant:"outline",className:"mr-auto cursor-pointer",onClick:O,children:"Reset"}),(0,t.jsx)(m.DialogClose,{asChild:!0,children:(0,t.jsx)(s.Button,{className:"cursor-pointer",variant:"secondary",children:"Cancel"})}),(0,t.jsx)(s.Button,{className:"cursor-pointer",type:"button",onClick:R,children:"Save"})]})]})]}),a&&(0,t.jsx)(f.EntityConfirmationDialog,{entityType:"Student",entity:{code:a.studentID,name:"".concat(a.firstName," ").concat(a.lastName)},actionType:"added",onClose:()=>l(null)})]})}function S(e){let{student:r,visible:a,onClose:l,onStudentUpdated:n}=e,[i,o]=(0,u.useState)([]),[d,v]=(0,u.useState)(r.studentID),[N,S]=(0,u.useState)(r.firstName),[y,b]=(0,u.useState)(r.lastName),[C,w]=(0,u.useState)(r.programCode),[D,I]=(0,u.useState)(r.yearLevel),[L,F]=(0,u.useState)(r.gender),[k,P]=(0,u.useState)(null),[B,T]=(0,u.useState)(""),[U,M]=(0,u.useState)(r.photoUrl),[V,A]=(0,u.useState)(null),E=(0,u.useRef)(null);(0,u.useEffect)(()=>{a&&(v(r.studentID),S(r.firstName),b(r.lastName),w(r.programCode),I(r.yearLevel),F(r.gender),M(r.photoUrl),T(""),(async()=>{try{let e=await (0,j.fetchStudent)(r.studentID);v(e.studentID),S(e.firstName),b(e.lastName),w(e.programCode),I(e.yearLevel),F(e.gender),M(e.photoUrl)}catch(e){console.error("Failed to fetch student data:",e)}})())},[a,r.studentID,r.firstName,r.lastName,r.programCode,r.yearLevel,r.gender,r.photoUrl]),(0,u.useEffect)(()=>{(async()=>{try{let e=await (0,p.fetchProgramsForDropdown)();o(e)}catch(e){console.error("Failed to load programs:",e),o([])}})()},[]);let R=async()=>{let e=r.studentID;if(!d.trim()||!N.trim()||!y.trim()||!C.trim()||!D.toString().trim()||!L.trim())return void T("Please fill in all fields.");if(!/^\d{4}-\d{4}$/.test(d.trim()))return void T("Student ID must follow the format YYYY-NNNN.");if(d.trim()===e.trim()&&N.trim()===r.firstName.trim()&&y.trim()===r.lastName.trim()&&C.trim()===r.programCode.trim()&&D===r.yearLevel&&L.trim()===r.gender.trim()&&r.photoUrl===U)return void T("No changes detected.");if(V){if(!["image/jpg","image/jpeg","image/png","image/svg+xml"].includes(V.type))return void T("Only image files are allowed.");if(V.size>2097152){T("Photo must be smaller than 2 MB."),E.current&&(E.current.value="");return}}try{let t=U||"/student-icon.jpg";if(V){let r=await (0,j.updateStudentAssets)(e,d.trim(),V);r&&(t=r)}else if(e!==d.trim()){let r=await (0,j.updateStudentAssets)(e,d.trim());r&&(t=r)}else"/student-icon.jpg"===U&&r.photoUrl&&"/student-icon.jpg"!==r.photoUrl&&(await (0,j.deleteStudentPhoto)(e,r.photoUrl),t="/student-icon.jpg");let a=await (0,j.updateStudent)(e,d.trim(),N.trim(),y.trim(),C.trim(),D,L.trim(),t);P(a),T("")}catch(e){e instanceof Error?"Student ID already exists"===e.message?T("Student ID (".concat(d,") is already taken.")):"Missing required fields"===e.message?T("Please fill in all required fields."):T(e.message||"Something went wrong. Try again."):T("Something went wrong. Try again.")}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Dialog,{open:a,onOpenChange:e=>{e||l()},children:(0,t.jsxs)(m.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(m.DialogHeader,{children:[(0,t.jsx)(m.DialogTitle,{children:"Edit Student"}),(0,t.jsx)(m.DialogDescription,{children:"Update the fields below to modify this student."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,t.jsx)(h.Label,{htmlFor:"photo",children:"Photo (optional)"}),(0,t.jsxs)("div",{className:"relative flex items-center justify-center",children:[U&&"/student-icon.jpg"!==U?(0,t.jsx)(c.default,{src:U,alt:"Current student photo",width:120,height:120,className:"!h-20 !w-20 rounded-full border border-gray-300 object-cover"}):(0,t.jsx)("div",{className:"flex !h-20 !w-20 cursor-pointer items-center justify-center rounded-full bg-gray-100 text-gray-500",onClick:()=>{var e;return null==(e=E.current)?void 0:e.click()},children:(0,t.jsx)("span",{className:"text-3xl font-bold",children:"+"})}),U&&"/student-icon.jpg"!==U&&(0,t.jsx)(s.Button,{variant:"destructive",size:"icon",onClick:()=>{A(null),M("/student-icon.jpg"),E.current&&(E.current.value="")},className:"absolute -top-2 -right-2 !h-5 !w-5 rounded-full bg-red-500 text-white hover:bg-red-600",children:"✕"})]}),(0,t.jsx)(s.Button,{variant:"outline",onClick:()=>{var e;return null==(e=E.current)?void 0:e.click()},className:"px-4 py-2",children:U&&"/student-icon.jpg"!==U?"Change Photo":"Upload Photo"}),(0,t.jsx)("input",{ref:E,id:"photo",type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;let r=(null==(t=e.target.files)?void 0:t[0])||null;A(r),r&&M(URL.createObjectURL(r))}})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"studentID",children:"Student ID"}),(0,t.jsx)(g.Input,{id:"studentID",value:d,placeholder:"e.g. 2023-0001",onChange:e=>{let t=e.target.value.replace(/\D/g,"");t.length>4&&(t=t.slice(0,4)+"-"+t.slice(4,8)),v(t)},maxLength:9})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"firstName",children:"First Name"}),(0,t.jsx)(g.Input,{id:"firstName",value:N,placeholder:"e.g. Juhanara",onChange:e=>S(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"lastName",children:"Last Name"}),(0,t.jsx)(g.Input,{id:"lastName",value:y,placeholder:"e.g. Saluta",onChange:e=>b(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"programCode",children:"Program"}),(0,t.jsxs)(x.Select,{value:C,onValueChange:w,children:[(0,t.jsx)(x.SelectTrigger,{children:(0,t.jsx)(x.SelectValue,{placeholder:"Select a program"})}),(0,t.jsx)(x.SelectContent,{children:i.map(e=>(0,t.jsxs)(x.SelectItem,{value:e.programCode,children:[e.programName," (",e.programCode,")"]},e.programCode))})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"yearLevel",children:"Year Level"}),(0,t.jsxs)(x.Select,{value:D.toString(),onValueChange:e=>I(Number(e)),children:[(0,t.jsx)(x.SelectTrigger,{children:(0,t.jsx)(x.SelectValue,{placeholder:"Select year level"})}),(0,t.jsxs)(x.SelectContent,{children:[(0,t.jsx)(x.SelectItem,{value:"1",children:"1"}),(0,t.jsx)(x.SelectItem,{value:"2",children:"2"}),(0,t.jsx)(x.SelectItem,{value:"3",children:"3"}),(0,t.jsx)(x.SelectItem,{value:"4",children:"4"}),(0,t.jsx)(x.SelectItem,{value:"5",children:"5"})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(h.Label,{htmlFor:"gender",children:"Gender"}),(0,t.jsxs)(x.Select,{value:L,onValueChange:F,children:[(0,t.jsx)(x.SelectTrigger,{children:(0,t.jsx)(x.SelectValue,{placeholder:"Select a gender"})}),(0,t.jsxs)(x.SelectContent,{children:[(0,t.jsx)(x.SelectItem,{value:"Female",children:"Female"}),(0,t.jsx)(x.SelectItem,{value:"Male",children:"Male"})]})]})]}),B&&(0,t.jsx)("div",{className:"text-sm text-red-600",children:B})]}),(0,t.jsxs)(m.DialogFooter,{children:[(0,t.jsx)(s.Button,{type:"button",variant:"outline",className:"mr-auto cursor-pointer",onClick:()=>{v(""),S(""),b(""),w(""),I(0),F(""),M(""),T("")},children:"Reset"}),(0,t.jsx)(m.DialogClose,{asChild:!0,children:(0,t.jsx)(s.Button,{className:"cursor-pointer",variant:"secondary",children:"Cancel"})}),(0,t.jsx)(s.Button,{className:"cursor-pointer",type:"button",onClick:R,children:"Save"})]})]})}),k&&(0,t.jsx)(f.EntityConfirmationDialog,{entityType:"Student",entity:{code:k.studentID,name:"".concat(k.firstName," ").concat(k.lastName)},actionType:"updated",onClose:()=>{P(null),null==n||n(),l()}})]})}function y(e){let{student:r,visible:a,onClose:l,onStudentDeleted:n}=e,[i,o]=(0,u.useState)(null),c=async()=>{try{await (0,j.deleteStudentFolder)(r.studentID),await (0,j.deleteStudent)(r.studentID),o(r)}catch(e){console.error("Failed to delete student:",e)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Dialog,{open:a,onOpenChange:e=>{e||l()},children:(0,t.jsxs)(m.DialogContent,{children:[(0,t.jsx)(m.DialogHeader,{children:(0,t.jsx)(m.DialogTitle,{children:"Confirm Deletion"})}),(0,t.jsxs)("p",{children:["Are you sure you want to delete"," ",(0,t.jsxs)("strong",{children:[r.firstName," ",r.lastName]})," ","(",r.studentID,")"]}),(0,t.jsxs)(m.DialogFooter,{children:[(0,t.jsx)(s.Button,{className:"cursor-pointer",variant:"secondary",onClick:()=>l(),children:"Cancel"}),(0,t.jsx)(s.Button,{className:"cursor-pointer",variant:"destructive",onClick:c,children:"Delete"})]})]})}),i&&(0,t.jsx)(f.EntityConfirmationDialog,{entityType:"Student",entity:{code:r.studentID,name:"".concat(r.firstName," ").concat(r.lastName)},actionType:"deleted",onClose:()=>{o(null),null==n||n(),l()}})]})}var b=e.i(24136),C=e.i(20733),w=e.i(88077),D=e.i(78823),I=e.i(71428),L=e.i(91918),F=e.i(25913),k=e.i(47163);let P=(0,F.cva)("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function B(e){let{className:r,variant:a,asChild:s=!1,...l}=e,n=s?L.Slot:"span";return(0,t.jsx)(n,{"data-slot":"badge",className:(0,k.cn)(P({variant:a}),r),...l})}function T(e){let{student:r,visible:a,onClose:s}=e,[l,n]=(0,u.useState)(r),[i,o]=(0,u.useState)([]);(0,u.useEffect)(()=>{a&&(async()=>{try{let e=await (0,j.fetchStudent)(r.studentID);n(e)}catch(e){console.error("Failed to fetch student data:",e)}})()},[a,r.studentID]),(0,u.useEffect)(()=>{(async()=>{try{let e=await (0,p.fetchProgramsForDropdown)();o(e)}catch(e){console.error("Failed to load programs:",e),o([])}})()},[]);let d=i.find(e=>e.programCode===l.programCode);return(0,t.jsx)(m.Dialog,{open:a,onOpenChange:e=>{e||s()},children:(0,t.jsxs)(m.DialogContent,{className:"sm:max-w-[400px]",children:[(0,t.jsx)(m.DialogHeader,{children:(0,t.jsx)(m.DialogTitle,{children:"Student Profile"})}),(0,t.jsxs)("div",{className:"container mt-5 mb-3",children:[(0,t.jsxs)("div",{className:"mb-8 flex flex-row",children:[l.photoUrl?(0,t.jsx)(c.default,{src:l.photoUrl,alt:"".concat(l.firstName," ").concat(l.lastName),width:150,height:150,className:"!h-15 !w-15 rounded-full object-cover"}):null,(0,t.jsxs)("div",{className:"ml-4 flex flex-col",children:[(0,t.jsxs)("span",{className:"mb-1 text-[18px] font-medium tracking-wide",children:[l.firstName," ",l.lastName]}),(0,t.jsx)(B,{className:"text-[10px] tracking-wide",children:l.studentID})]})]}),(0,t.jsxs)("div",{className:"mr-5 ml-5 flex flex-col gap-2 rounded-sm p-5 shadow-sm",children:[(0,t.jsxs)("div",{className:"mb-5 flex flex-col",children:[(0,t.jsx)("span",{className:"text-muted-foreground mb-2 text-[11px] tracking-wide",children:"Program"}),d?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("span",{className:"text-sm",children:d.programName})}):(0,t.jsx)("span",{className:"text-sm",children:l.programCode})]}),(0,t.jsxs)("div",{className:"mb-5 flex flex-col",children:[(0,t.jsx)("span",{className:"text-muted-foreground mb-2 text-[11px] tracking-wide",children:"College"}),d?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("span",{className:"text-sm",children:d.collegeCode})}):(0,t.jsx)("span",{className:"text-sm",children:"N/A"})]}),(0,t.jsxs)("div",{className:"mb-5 flex flex-col",children:[(0,t.jsx)("span",{className:"text-muted-foreground mb-2 text-[11px] tracking-wide",children:"Year Level"}),(0,t.jsx)("span",{className:"text-sm",children:l.yearLevel})]}),(0,t.jsxs)("div",{className:"mb-5 flex flex-col",children:[(0,t.jsx)("span",{className:"text-muted-foreground mb-2 text-[11px] tracking-wide",children:"Gender"}),(0,t.jsx)("span",{className:"text-sm",children:l.gender})]})]})]})]})})}function U(){let e,m,{authenticated:g,loading:h}=(0,b.useAuth)(),[p,j]=(0,u.useState)(!0),[f,v]=(0,u.useState)(!1),[L,F]=(0,u.useState)([]),[k,P]=(0,u.useState)(0),[B,U]=(0,u.useState)(0),[M,V]=(0,u.useState)(0),[A,E]=(0,u.useState)(null),[R,O]=(0,u.useState)(null),[z,K]=(0,u.useState)(null),[Y,X]=(0,u.useState)("all"),[H,G]=(0,u.useState)(""),[q,J]=(0,u.useState)([]);(0,u.useEffect)(()=>{(async()=>{try{let{students:e,total:t}=await (0,C.loadStudents)();F(e),V(t)}catch(e){console.error("Failed to load students:",e)}finally{j(!1)}})()},[]),(0,u.useEffect)(()=>{(async()=>{try{let{total:e}=await (0,C.loadColleges)();P(e)}catch(e){console.error("Failed to load colleges:",e)}})()},[]),(0,u.useEffect)(()=>{(async()=>{try{let{total:e}=await (0,C.loadPrograms)();U(e)}catch(e){console.error("Failed to load programs:",e)}})()},[]);let $=async()=>{v(!0);try{let{students:e,total:t}=await (0,C.loadStudents)();F(e),V(t)}catch(e){console.error("Failed to refresh students:",e)}finally{v(!1)}},_=L.filter(e=>{let t=H.toLowerCase();return!t||("studentID"===Y?e.studentID.toLowerCase().includes(t):"firstName"===Y?e.firstName.toLowerCase().includes(t):"lastName"===Y?e.lastName.toLowerCase().includes(t):"programCode"===Y?e.programCode.toLowerCase().includes(t):"yearLevel"===Y?e.yearLevel.toString().includes(t):"gender"===Y?e.gender.toLowerCase().includes(t):e.studentID.toLowerCase().includes(t)||e.firstName.toLowerCase().includes(t)||e.lastName.toLowerCase().includes(t)||e.programCode.toLowerCase().includes(t)||e.yearLevel.toString().includes(t)||e.gender.toLowerCase().includes(t))});return h||p?(0,t.jsx)(w.PageSkeleton,{}):g||h?(0,t.jsxs)("div",{className:"container w-full justify-center px-6",children:[(0,t.jsx)(r.CardDemographic,{colleges:k,programs:B,students:M}),(0,t.jsxs)("div",{className:"container mt-5 mb-2 flex flex-col",children:[(0,t.jsx)("h1",{className:"mb text-2xl font-semibold tracking-wide",children:"Students"}),(0,t.jsx)("p",{className:"mb tracking-wide",children:"Here's the list of students."})]}),(0,t.jsxs)("div",{className:"mb-4 flex",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(D.SearchInput,{value:H,onChange:G,total:_.length}),(0,t.jsxs)(x.Select,{value:Y,onValueChange:e=>X(e),children:[(0,t.jsx)(x.SelectTrigger,{className:"w-[150px] cursor-pointer",children:(0,t.jsx)(x.SelectValue,{placeholder:"Search By"})}),(0,t.jsxs)(x.SelectContent,{children:[(0,t.jsx)(x.SelectItem,{className:"cursor-pointer",value:"all",children:"Search By"}),(0,t.jsx)(x.SelectItem,{className:"cursor-pointer",value:"studentID",children:"Student ID"}),(0,t.jsx)(x.SelectItem,{className:"cursor-pointer",value:"firstName",children:"First Name"}),(0,t.jsx)(x.SelectItem,{className:"cursor-pointer",value:"lastName",children:"Last Name"}),(0,t.jsx)(x.SelectItem,{className:"cursor-pointer",value:"programCode",children:"Program Code"}),(0,t.jsx)(x.SelectItem,{className:"cursor-pointer",value:"yearLevel",children:"Year Level"}),(0,t.jsx)(x.SelectItem,{className:"cursor-pointer",value:"gender",children:"Gender"})]})]})]}),(0,t.jsx)("div",{className:"ml-auto",children:(0,t.jsx)(N,{onStudentAdded:$})})]}),(0,t.jsx)("div",{className:"container",children:f?(0,t.jsx)(I.Skeleton,{className:"container mx-auto h-[300px] rounded-xl py-10"}):0===L.length?(0,t.jsx)("div",{className:"text-muted-foreground py-6 text-center",children:"No data."}):(0,t.jsxs)("div",{className:"mb-2 opacity-100 transition-opacity duration-300",children:[(0,t.jsx)(d.DataTable,{columns:(e=e=>{E(e)},m=e=>{O(e)},[{accessorKey:"photoUrl",size:60,header:"Photo",cell:e=>{let{row:r}=e;console.log("Row data:",r.original);let a=r.original.photoUrl,s="".concat(r.original.firstName," ").concat(r.original.lastName);return a?(0,t.jsx)(c.default,{src:a,alt:s,width:40,height:40,className:"!h-10 !w-10 rounded-full object-cover"}):(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-gray-200 text-xs",children:"N/A"})}},{accessorKey:"studentID",size:150,header:e=>{let{column:r}=e;return(0,t.jsxs)(s.Button,{onClick:()=>r.toggleSorting("asc"===r.getIsSorted()),className:"text-foreground cursor-pointer bg-transparent hover:bg-transparent",children:["Student ID","asc"===r.getIsSorted(),"desc"===r.getIsSorted()]})},cell:e=>{var t;let{getValue:r}=e;return null!=(t=r())?t:"—"}},{accessorKey:"firstName",header:e=>{let{column:r}=e;return(0,t.jsxs)(s.Button,{onClick:()=>r.toggleSorting("asc"===r.getIsSorted()),className:"text-foreground cursor-pointer bg-transparent hover:bg-transparent",children:["First Name","asc"===r.getIsSorted(),"desc"===r.getIsSorted()]})},cell:e=>{var t;let{getValue:r}=e;return null!=(t=r())?t:"—"}},{accessorKey:"lastName",header:e=>{let{column:r}=e;return(0,t.jsxs)(s.Button,{onClick:()=>r.toggleSorting("asc"===r.getIsSorted()),className:"text-foreground cursor-pointer bg-transparent hover:bg-transparent",children:["Last Name","asc"===r.getIsSorted(),"desc"===r.getIsSorted()]})},cell:e=>{var t;let{getValue:r}=e;return null!=(t=r())?t:"—"}},{accessorKey:"programCode",header:e=>{let{column:r}=e;return(0,t.jsxs)(s.Button,{onClick:()=>r.toggleSorting("asc"===r.getIsSorted()),className:"text-foreground cursor-pointer bg-transparent hover:bg-transparent",children:["Program Code","asc"===r.getIsSorted(),"desc"===r.getIsSorted()]})},cell:e=>{let{row:r}=e,a=r.getValue("programCode");return"N/A"===a?(0,t.jsx)("span",{className:"text-muted-foreground italic",children:"N/A"}):a}},{accessorKey:"yearLevel",header:e=>{let{column:r}=e;return(0,t.jsxs)(s.Button,{onClick:()=>r.toggleSorting("asc"===r.getIsSorted()),className:"text-foreground cursor-pointer bg-transparent hover:bg-transparent",children:["Year Level","asc"===r.getIsSorted(),"desc"===r.getIsSorted()]})},cell:e=>{var t;let{getValue:r}=e;return null!=(t=r())?t:"—"}},{accessorKey:"gender",header:e=>{let{column:r}=e;return(0,t.jsxs)(s.Button,{onClick:()=>r.toggleSorting("asc"===r.getIsSorted()),className:"text-foreground cursor-pointer bg-transparent hover:bg-transparent",children:["Gender","asc"===r.getIsSorted(),"desc"===r.getIsSorted()]})},cell:e=>{var t;let{getValue:r}=e;return null!=(t=r())?t:"—"}},{id:"actions",size:100,cell:r=>{let{row:c}=r,d=c.original;return(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsxs)(l.DropdownMenu,{children:[(0,t.jsx)(l.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(s.Button,{variant:"ghost",className:"h-5 w-8 cursor-pointer p-0",children:[(0,t.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,t.jsx)(a.MoreHorizontal,{className:"h-4 w-4"})]})}),(0,t.jsxs)(l.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(l.DropdownMenuLabel,{children:"Actions"}),(0,t.jsx)(l.DropdownMenuSeparator,{}),(0,t.jsxs)(s.Button,{variant:"ghost",className:"flex w-full cursor-pointer justify-between",onClick:()=>e(d),children:[(0,t.jsx)("span",{children:"View"}),(0,t.jsx)(o,{className:"text-muted-foreground h-4 w-4 justify-end"})]}),(0,t.jsx)(l.DropdownMenuSeparator,{className:"mr-2 ml-2"}),(0,t.jsxs)(s.Button,{variant:"ghost",className:"flex w-full cursor-pointer justify-between",onClick:()=>m(d),children:[(0,t.jsx)("span",{children:"Edit"}),(0,t.jsx)(n.default,{className:"text-muted-foreground ml-auto h-4 w-4 justify-end"})]}),(0,t.jsxs)(s.Button,{variant:"ghost",className:"flex w-full cursor-pointer justify-between",onClick:()=>K(d),children:[(0,t.jsx)("span",{children:"Delete"}),(0,t.jsx)(i.default,{className:"text-muted-foreground h-4 w-4 justify-end"})]})]})]})})}}]),data:_,sorting:q,setSorting:J}),A&&(0,t.jsx)(T,{student:A,visible:!0,onClose:()=>E(null)}),R&&(0,t.jsx)(S,{student:R,visible:!0,onClose:()=>O(null),onStudentUpdated:()=>{$(),O(null)}}),z&&(0,t.jsx)(y,{student:z,visible:!0,onClose:()=>K(null),onStudentDeleted:()=>{$(),K(null)}})]})})]}):(0,t.jsx)("div",{className:"text-muted-foreground py-6 text-center",children:"Redirecting to login..."})}}]);